function hyphenate(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function isVisible(t){if(t.is(":hidden"))return!1;var e=$(window).scrollTop(),o=e+$(window).height(),i=t.offset().top,n=i+t.height();return i>=e&&n<=o||i<=e&&n>=e||i<=o&&n>=o}function smoothScrollTo(t,e){$("html, body").animate({scrollTop:t.offset().top},250,e)}var behaviors={};behaviors.sections=function(){function t(){$.each(n,function(){if(this())return!1})}function e(){a.height("auto");var t=$(document).height()-a.offset().top-$(window).outerHeight();t<0&&a.height($(window).height())}var o,i=$(".toc"),n=[];$(document).scroll(t),$(window).resize(t),setTimeout(t,0),$("article section").each(function(){function t(){o&&o.removeClass("active"),h.addClass("active"),o=h}var e=$(this),a=$("a",e);e.append(e.nextUntil("section"));var r=a.attr("title")||$("h1,h2",e).first().text(),c=e.attr("id");if(c||(c=hyphenate(r).replace(/\s+/g,"-").replace(/^#/,"").replace(/[!"#$%&'\()*+,.\/:;<=>?@\[\\\]\^_`{|}~]+/g,"-").replace(/-+/g,"-"),e.attr("id",c),a.attr("name",c)),i){var h=$('<li><a href="#'+c+'">'+r+"</a></li>").appendTo(i);n.push(function(){var o=isVisible(e);return o&&t(),o})}}),$("article").delegate("a, h2","click",function(t){var e=$(t.target).closest("section");return smoothScrollTo(e,function(){window.location.hash=e.attr("id")}),!1}),$(".toc").delegate("li a","click",function(t){var e=$(t.target).attr("href"),o=$(e);return smoothScrollTo(o,function(){window.location.hash=e}),!1});var a=$("article section:last"),r=$("a[name]",a);a.length&&r.length&&($(window).on({load:e,resize:e}),e())},behaviors.hash=function(){var t=unescape(window.location.hash);if(t){var e=$(t);e.length&&smoothScrollTo(e)}},$(function(){for(var t in behaviors)behaviors[t]()});